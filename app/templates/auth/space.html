{% extends "base.html" %}
{% block title %}
{{ user.nickname }} - 个人空间
{% endblock %}
{% block content %}
{% block head %}
{{ super() }}
<script>
        function get_follow() {
            var path = window.location.pathname;
            var uid_2 = path.split("/")[3];
            $.post("/auth/api/hasFollow", {"uid_2": uid_2}, function(data) {
                if(data == false) {
                    $("#follow-info").text("关注");
                }
                else {
                    $("#follow-info").text("取消关注");
                }
            });
        }
        get_follow();
        function deal_follow() {
            var text = $("#follow-info").text();
            if(text == "关注") {
                follow();
            }
            else {
                unfollow();
            }
        }
        function follow() {
            var path = window.location.pathname;
            var uid_2 = path.split("/")[3];
            var d = new Date();
            var d_follow = d.toLocaleDateString();
    
            $.post("/auth/api/follow", {
                "uid_2": uid_2,
                "d_follow": d_follow
            }, function(data) {
                $("#follow-info").text("取消关注");
            })
        }
        function unfollow() {
            var path = window.location.pathname;
            var uid_2 = path.split("/")[3];
            var d = new Date();
            var d_follow = d.toLocaleDateString();
    
            $.post("/auth/api/unfollow", {
                "uid_2": uid_2,
                "d_follow": d_follow
            }, function(data) {
                $("#follow-info").text("关注");
            }) 
        }
    </script>
{% endblock %}

<div class="row">
    <div class="col-md-2"></div>
    <div class="col-md-6">
        <div class="profile-info">
            <div class="row">
                <div class="col-md-4">
                    <h1>{{user.nickname}}</h1>
                </div>
                <div class="col-md-4">
                    <button id="follow-info" class="follow" onclick="deal_follow()">关注</button>
                </div>
            </div>
            <div class="detail">
                <div class="row detail-entry">
                    <div class="col-md-2 detail-title">
                        <label>性别</label>
                    </div>
                    <div class="col-md-8 detail-info">
                        <label>{{ user.sex }}</label>
                    </div>
                </div>
                <div class="row detail-entry">
                    <div class="col-md-2 detail-title">
                        <label>生日</label>
                    </div>
                    <div class="col-md-8 detail-info">
                        <label>{{ user.date_birth }}</label>
                    </div>
                </div>
                <div class="row detail-entry">
                    <div class="col-md-2 detail-title">
                        <label>签名</label>
                    </div>
                    <div class="col-md-8 detail-info">
                        <label>{{ user.signature }}</label>
                    </div>
                </div>
                <div class="row detail-entry">
                    <div class="col-md-2 detail-title">
                        <label>关注</label>
                    </div>
                    <div class="col-md-8 detail-info">
                        <label>{{ user.follow }}</label>
                    </div>
                </div>
                <div class="row detail-entry">
                    <div class="col-md-2 detail-title">
                        <label>粉丝</label>
                    </div>
                    <div class="col-md-8 detail-info">
                        <label>{{ user.fans }}</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="row">
            <img class="profile-photo" src="{{user.profile_photo}}">
        </div>
            
    </div>
</div>


{% endblock %}
